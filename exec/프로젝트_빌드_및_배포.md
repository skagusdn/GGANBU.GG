# ğŸ› í”„ë¡œì íŠ¸ ë¹Œë“œ ë° ë°°í¬

## âš™ì‹œìŠ¤í…œ í™˜ê²½ ë° êµ¬ì„±

- OS: Windows10, Linux
- Backend Framework: Spring Boot 2.7.1
- Frontend Framework: React 18.2.0
- DB: mysql Ver 8.0.30-0ubuntu0.20.04.2 (Ubuntu)
- WAS: Gradle
- JVM: openJDK (1.8.0_192)
- Node.js: 16.16.0
- npm: 8.5.5
- WebRTC: openVidu 2.20.0
- Docker: 20.10.12
- WEB: Nginx (1.18.0)

<br/><br/><br/>

## DB ì ‘ì† ì •ë³´ ë° í”„ë¡œí¼í‹°
### Database ì ‘ê·¼

> ID: seveneleven

> PW: 7c111

<br/><br/><br/>

## EC2ì— MySQL ì„¤ì¹˜ ë° ì„¸íŒ…

### MySQL ì„¤ì¹˜ ë° ì„¸íŒ…

```shell
# ìš°ë¶„íˆ¬ ì„œë²„ ì—…ë°ì´íŠ¸
$ sudo apt-get update

# ì„¤ì¹˜
$ sudo apt-get install mysql-server

# êµ¬ë™
$ sudo systemctl start mysql.service
```

<br/>

```shell
# MySQL ì ‘ì†
$ sudo mysql

# í˜„ì¬ mysqlì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì„¸íŒ…ë˜ì–´ìˆëŠ” ìœ ì € í™•ì¸
mysql> SELECT user,authentication_string,plugin,host FROM mysql.user;
```

![image](/uploads/24b69a7b312f693a240f3b90dcd27da8/image.png)

<br/>

```bash
# DBì— ì™¸ë¶€ ì ‘ì†í•˜ê¸° ìœ„í•´ ìƒˆë¡œìš´ ê³„ì • ìƒì„± (% : ì–´ë–¤ ipë¡œë„ ì ‘ì† ê°€ëŠ¥í•˜ë„ë¡ í•˜ê¸° ìœ„í•¨)
mysql> CREATE USER 'ê³„ì •ì´ë¦„'@'%' IDENTIFIED BY 'ë¹„ë°€ë²ˆí˜¸';

# ê¶Œí•œ ë¶€ì—¬
mysql> GRANT ALL PRIVILEGES ON *.* TO 'ê³„ì •ì´ë¦„'@'%' WITH GRANT OPTION;

mysql> FLUSH PRIVILEGES;
```

<br/>

### MySQL Workbench ì„¤ì¹˜í•´ì„œ EC2ì— ìˆëŠ” DBì™€ ì—°ê²°í•˜ê¸°

```shell
# ì™¸ë¶€ ì ‘ì† í—ˆìš© ì„¤ì •
$ cd /etc/mysql/mysql.conf.d
$ vi mysqld.cnf
```

<br/>
- i ëˆŒëŸ¬ì„œ ì…ë ¥ ëª¨ë“œë¡œ ë³€ê²½ í›„ bind-address ë¥¼ 0.0.0.0 ìœ¼ë¡œ ìˆ˜ì • í›„ ì €ì¥í•˜ê³  ë‚˜ê°€ê¸°

![image](/uploads/aef0965954c94c806f1840695777ce38/image.png)

<br/>

```shell
# EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ 3306 í¬íŠ¸ ì—´ê¸°
$ sudo ufw allow 3306

# MySQL ì¬ì‹œì‘
$ sudo systemctl restart mysql.service
```

<br/>

- Workbenchë¡œ ì´ë™

    ![image](/uploads/2b83489d5937b38e6caa03c604154662/image.png)
    - Connection Name: í•˜ê³  ì‹¶ì€ Connection ëª…
    - SSH Hostname: ì ‘ì†í•  ë„ë©”ì¸ ë„¤ì„ì´ë‚˜ IP
    - SSH Key File: ì¸ì¦í‚¤
    - Username: ì´ˆë°˜ì— ìƒì„±í•œ MySQL Username

<br/><br/><br/>

## Backend ë°°í¬ - Spring Boot
- .jar íŒŒì¼ì´ ìˆëŠ” ìœ„ì¹˜ì—ì„œ ëª…ë ¹ì–´ ì‹¤í–‰

```shell
$ java -jar <.jar íŒŒì¼ ì´ë¦„>.jar & # &ëŠ” ë°°ê²½ì—ì„œ ì„œë²„ê°€ ëŒì•„ê°€ê²Œë” í•´ì¤Œ
```

<br/><br/><br/>

## Frontend ë°°í¬ - React
```shell
# EC2 ì„œë²„ì— node.jsì™€ npm ì„¤ì¹˜
$ sudo apt update
$ sudo apt install nodejs
$ sudo apt install npm

# react ë””ë ‰í† ë¦¬ë¡œ ì´ë™ í›„ ì‹¤í–‰
$ npm i
$ npm run build
$ npm start
```

<br/><br/><br/>

## OpenVidu ë°°í¬
```shell
$ docker run -p 4443:4443 --rm -e OPENVIDU_SECRET=MY_SECRET openvidu/openvidu-server-kms:2.22.0
```

<br/><br/><br/>

## NginX ì„¤ì¹˜
```shell
# ì„¤ì¹˜
$ sudo apt install nginx

# nginx ì‹œì‘
$ sudo service nginx start

# nginx status í™•ì¸
$ sudo service nginx status
```

![image](/uploads/078f098d56c3f6639899f4019505571d/image.png)

<br/>

- nginxëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 80í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ 80í¬íŠ¸ ì—´ì–´ì£¼ê¸°

```shell
$ sudo ufw allow 80
```

<br/>

- default ì„¤ì • íŒŒì¼ì— ë“¤ì–´ê°€ì„œ í”„ë¡œì íŠ¸ì— ë§ëŠ” í™˜ê²½ì„¤ì •
```shell
$ sudo vi /etc/nginx/sites-available/default
```


<br/>

- ì„¤ì • ë³€ê²½ í›„ synxax ê²€ì‚¬í•˜ê³  NginX ì¬ì‹œì‘
```shell
$ sudo nginx -t
$ sudo systemctl restart nginx
```

<br/><br/><br/>

## SSL ì ìš©
```shell
# letsencrypt ì„¤ì¹˜
$ sudo apt-get update
$ sudo apt-get install letsencrypt

# NginX ì¤‘ì§€ (80 í¬íŠ¸ ì‚¬ìš© ì‹œ ì—ëŸ¬ë‚  ìˆ˜ ìˆìŒ)
$ sudo systemctl stop nginx

# ì¸ì¦ì„œ ë°œê¸‰
$ sudo letsencrypt certonly --standalone -d [ë„ë©”ì¸ ë„¤ì„]

# ì •ìƒ ë°œê¸‰ ì‹œ /etc/letsencrypt/live/[ë„ë©”ì¸ ë„¤ì„] í´ë” ì•ˆì— í‚¤ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ
# ex) fullchain.pem, privkey.pem
```

<br/>

- NginX ì„¤ì • íŒŒì¼ ìˆ˜ì •, Proxy ì„¤ì •

![image](/uploads/5eb5810580f429b211ea5ef7c6cc3b12/image.png)


<br/>

- NginX ê°€ë™

```shell
$ sudo systemctl start nginx
```

<br/><br/><br/>


